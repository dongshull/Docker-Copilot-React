# GitHub Actions å·¥ä½œæµæŒ‡å—

è¿™ä¸ªé¡¹ç›®åŒ…å«ä¸‰ä¸ªä¸»è¦çš„ GitHub Actions å·¥ä½œæµï¼Œç”¨äºè‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ã€‚

## ğŸ“‹ å·¥ä½œæµæ¦‚è§ˆ

### 1. Build and Push (`build-and-push.yml`)
è‡ªåŠ¨æ„å»º Docker é•œåƒå¹¶æ¨é€åˆ° GitHub Container Registry

**è§¦å‘æ¡ä»¶**:
- æ¨é€åˆ° `master`, `main`, `dev` åˆ†æ”¯
- æºä»£ç æˆ–æ„å»ºç›¸å…³æ–‡ä»¶å˜æ›´
- æ‹‰å–è¯·æ±‚åˆ°ä¸»åˆ†æ”¯
- æ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰

**æµç¨‹**:
1. âœ… æ£€å‡ºä»£ç 
2. ğŸ—ï¸ è®¾ç½® Docker Buildxï¼ˆæ”¯æŒå¤šå¹³å°æ„å»ºï¼‰
3. ğŸ” ç™»å½•åˆ° GitHub Container Registry
4. ğŸ³ æ„å»ºå¹¶æ¨é€ Docker é•œåƒ
5. âœ¨ æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥
6. ğŸ“¦ åˆ›å»º GitHub Release

**è¾“å‡º**:
- Docker é•œåƒæ¨é€åˆ° `ghcr.io`
- è‡ªåŠ¨åˆ›å»º GitHub Release

### 2. Code Quality (`code-quality.yml`)
æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥å’Œå®‰å…¨æ‰«æ

**è§¦å‘æ¡ä»¶**:
- æ‹‰å–è¯·æ±‚
- æ¨é€åˆ°ä»»ä½•åˆ†æ”¯
- æ‰‹åŠ¨è§¦å‘

**æ£€æŸ¥é¡¹**:
- ğŸ” ESLint ä»£ç æ£€æŸ¥
- ğŸ“¦ ä¾èµ–å®‰å…¨å®¡è®¡ï¼ˆnpm auditï¼‰
- ğŸ” Snyk å®‰å…¨æ‰«æï¼ˆå¯é€‰ï¼Œéœ€è¦ Tokenï¼‰
- ğŸ§ª è¿è¡Œæµ‹è¯•ï¼ˆå¦‚æœé…ç½®ï¼‰
- ğŸ“ˆ æ„å»ºäº§ç‰©å¤§å°æ£€æŸ¥

**æŠ¥å‘Š**:
- ç”Ÿæˆè´¨é‡æ£€æŸ¥æŠ¥å‘Š
- ä»£ç æ ¼å¼æ£€æŸ¥
- å®‰å…¨æ¼æ´æŠ¥å‘Š

### 3. Deploy (`deploy.yml`)
è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

**è§¦å‘æ¡ä»¶**:
- GitHub Release å‘å¸ƒ
- æ‰‹åŠ¨è§¦å‘ï¼ˆæ”¯æŒé€‰æ‹©éƒ¨ç½²ç›®æ ‡ï¼‰

**éƒ¨ç½²æ­¥éª¤**:
1. ğŸ“¦ æ„å»º Docker é•œåƒ
2. ğŸš€ æ¨é€åˆ° Container Registry
3. ğŸ“¢ å‘é€éƒ¨ç½²é€šçŸ¥

## ğŸ” æ‰€éœ€é…ç½®

### GitHub Secrets

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­é…ç½®ä»¥ä¸‹ Secretsï¼ˆSettings > Secrets and variables > Actionsï¼‰ï¼š

#### å¿…éœ€
- `GITHUB_TOKEN`: GitHub è‡ªåŠ¨æä¾›ï¼Œç”¨äºæ¨é€é•œåƒå’Œåˆ›å»º Release

#### å¯é€‰
- `SNYK_TOKEN`: Snyk å®‰å…¨æ‰«æ Tokenï¼ˆä» [snyk.io](https://snyk.io) è·å–ï¼‰
- `WEBHOOK_URL`: è‡ªå®šä¹‰ Webhook URLï¼ˆç”¨äºé€šçŸ¥é›†æˆï¼‰

### è®¾ç½®æ­¥éª¤

1. **è¿›å…¥ä»“åº“è®¾ç½®**
   ```
   Settings > Secrets and variables > Actions
   ```

2. **æ·»åŠ  Secrets**
   - ç‚¹å‡» "New repository secret"
   - è¾“å…¥ Secret åç§°å’Œå€¼

3. **éªŒè¯ Token æƒé™**
   - ç¡®ä¿ `GITHUB_TOKEN` æœ‰ `contents: write` å’Œ `packages: write` æƒé™

## ğŸš€ ä½¿ç”¨æŒ‡å—

### è‡ªåŠ¨è§¦å‘

å·¥ä½œæµä¼šåœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨è¿è¡Œï¼š

```yaml
# æ¨é€ä»£ç åˆ°ä¸»åˆ†æ”¯
git push origin master

# åˆ›å»ºæ‹‰å–è¯·æ±‚
gh pr create

# åˆ›å»º Releaseï¼ˆè‡ªåŠ¨éƒ¨ç½²ï¼‰
gh release create v1.0.0
```

### æ‰‹åŠ¨è§¦å‘

åœ¨ GitHub ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µï¼š

1. é€‰æ‹©å·¥ä½œæµ
2. ç‚¹å‡» **Run workflow**
3. é€‰æ‹©åˆ†æ”¯å’Œå‚æ•°
4. ç‚¹å‡» **Run workflow**

## ğŸ“Š ç›‘æ§å·¥ä½œæµ

### æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€

1. è¿›å…¥ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µ
2. é€‰æ‹©å·¥ä½œæµ
3. æŸ¥çœ‹æœ€è¿‘çš„è¿è¡Œè®°å½•

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

1. ç‚¹å‡»å·¥ä½œæµè¿è¡Œ
2. ç‚¹å‡»å…·ä½“çš„ Job
3. å±•å¼€æ­¥éª¤æŸ¥çœ‹æ—¥å¿—è¾“å‡º

### å¾½ç« çŠ¶æ€

æ·»åŠ å·¥ä½œæµçŠ¶æ€å¾½ç« åˆ° READMEï¼š

```markdown
![Build Status](https://github.com/YOUR_USERNAME/Docker-Copilot-React/actions/workflows/build-and-push.yml/badge.svg)
![Code Quality](https://github.com/YOUR_USERNAME/Docker-Copilot-React/actions/workflows/code-quality.yml/badge.svg)
```

## ğŸ”„ å·¥ä½œæµè¯¦è§£

### Build and Push å·¥ä½œæµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»£ç æ¨é€åˆ° master     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€å‡ºä»£ç               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¾ç½® Docker Buildx    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™»å½•é•œåƒä»“åº“          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ„å»º Docker é•œåƒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»£ç è´¨é‡æ£€æŸ¥          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»º GitHub Release   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ„å»ºçŸ©é˜µç­–ç•¥

ä»£ç è´¨é‡æ£€æŸ¥åœ¨å¤šä¸ª Node.js ç‰ˆæœ¬ä¸Šè¿è¡Œï¼š

```yaml
strategy:
  matrix:
    node-version: [18.x]
```

å¯ä»¥æ‰©å±•ä¸ºï¼š

```yaml
strategy:
  matrix:
    node-version: [16.x, 18.x, 20.x]
```

## ğŸ”§ è‡ªå®šä¹‰å·¥ä½œæµ

### ä¿®æ”¹è§¦å‘æ¡ä»¶

ç¼–è¾‘å·¥ä½œæµæ–‡ä»¶ä¸­çš„ `on` éƒ¨åˆ†ï¼š

```yaml
on:
  push:
    branches:
      - master
      - custom-branch  # æ·»åŠ è‡ªå®šä¹‰åˆ†æ”¯
  pull_request:
    branches:
      - master
```

### æ·»åŠ è‡ªå®šä¹‰æ­¥éª¤

åœ¨å·¥ä½œæµä¸­æ·»åŠ æ–°çš„æ­¥éª¤ï¼š

```yaml
- name: Custom step
  run: |
    echo "Running custom commands"
    npm run custom-script
```

### æ·»åŠ ç¯å¢ƒå˜é‡

```yaml
env:
  CUSTOM_VAR: value

jobs:
  build:
    steps:
      - run: echo ${{ env.CUSTOM_VAR }}
```

### æ¡ä»¶æ‰§è¡Œ

```yaml
- name: Conditional step
  if: github.event_name == 'push'
  run: npm run build
```

## ğŸ“ æœ€ä½³å®è·µ

1. **ä½¿ç”¨æœ€æ–°çš„ Action ç‰ˆæœ¬**
   ```yaml
   uses: docker/build-push-action@v5  # æŒ‡å®šå…·ä½“ç‰ˆæœ¬
   ```

2. **ç¼“å­˜ä¾èµ–**
   ```yaml
   - uses: actions/setup-node@v4
     with:
       cache: 'npm'
   ```

3. **å¹¶è¡Œæ‰§è¡Œ Job**
   ```yaml
   jobs:
     build:
       # ...
     test:
       # ...
     deploy:
       needs: [build, test]  # ç­‰å¾…å‰ä¸¤ä¸ª job å®Œæˆ
   ```

4. **ä½¿ç”¨ continue-on-error å¤„ç†å¯é€‰æ­¥éª¤**
   ```yaml
   - run: npm run lint
     continue-on-error: true  # å³ä½¿å¤±è´¥ä¹Ÿç»§ç»­
   ```

5. **è¾“å‡ºæœ‰ç”¨çš„æ—¥å¿—ä¿¡æ¯**
   ```yaml
   - run: |
       echo "âœ… æ„å»ºæˆåŠŸ"
       echo "ğŸ“¦ é•œåƒ: ${{ env.IMAGE_NAME }}"
   ```

## ğŸ› æ•…éšœæ’æŸ¥

### å·¥ä½œæµä¸è§¦å‘

**é—®é¢˜**: Push ä»£ç ä½†å·¥ä½œæµæœªè¿è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥åˆ†æ”¯åç§°æ˜¯å¦åŒ¹é… `on.push.branches`
- ç¡®è®¤æ–‡ä»¶å˜æ›´åŒ¹é… `on.push.paths`
- æ£€æŸ¥ä»“åº“ Settings > Actions æƒé™

### é•œåƒæ¨é€å¤±è´¥

**é—®é¢˜**: Docker é•œåƒæ¨é€åˆ°ä»“åº“å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
- éªŒè¯ `GITHUB_TOKEN` æƒé™
- æ£€æŸ¥ä»“åº“æ˜¯å¦ä¸ºç§æœ‰
- æŸ¥çœ‹å·¥ä½œæµæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯

### æ„å»ºå¤±è´¥

**é—®é¢˜**: Docker é•œåƒæ„å»ºå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
- æŸ¥çœ‹æ„å»ºæ—¥å¿—
- éªŒè¯ Dockerfile è¯­æ³•
- æ£€æŸ¥ä¾èµ–å®‰è£…
- ç¡®è®¤æºä»£ç æ²¡æœ‰é”™è¯¯

## ğŸ“š ç›¸å…³èµ„æº

- [GitHub Actions å®˜æ–¹æ–‡æ¡£](https://docs.github.com/en/actions)
- [GitHub Actions å¸‚åœº](https://github.com/marketplace?type=actions)
- [Docker æ„å»º Action](https://github.com/docker/build-push-action)
- [Snyk Action](https://github.com/snyk/actions)

## ğŸ’¡ ç¤ºä¾‹é›†æˆ

### æ·»åŠ å·¥ä½œæµçŠ¶æ€å¾½ç« 

åœ¨ README.md ä¸­æ·»åŠ ï¼š

```markdown
## ğŸ”„ CI/CD çŠ¶æ€

![Build](https://github.com/YOUR_REPO/actions/workflows/build-and-push.yml/badge.svg)
![Code Quality](https://github.com/YOUR_REPO/actions/workflows/code-quality.yml/badge.svg)
![Deploy](https://github.com/YOUR_REPO/actions/workflows/deploy.yml/badge.svg)
```

### åœ¨ Release ä¸­æ·»åŠ é•œåƒä¿¡æ¯

Release Notes ä¼šè‡ªåŠ¨åŒ…å«ï¼š
- Docker é•œåƒåœ°å€
- ç‰ˆæœ¬æ ‡ç­¾
- æ‹‰å–å‘½ä»¤
- è¿è¡Œå‘½ä»¤

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… æ¨é€ä»£ç åˆ°ä»“åº“
2. âœ… æŸ¥çœ‹ Actions æ ‡ç­¾é¡µç¡®è®¤å·¥ä½œæµè¿è¡Œ
3. âœ… é…ç½®å¯é€‰çš„ Secretsï¼ˆå¦‚ Snyk Tokenï¼‰
4. âœ… åˆ›å»ºç¬¬ä¸€ä¸ª Release æµ‹è¯•éƒ¨ç½²å·¥ä½œæµ
5. âœ… è‡ªå®šä¹‰å·¥ä½œæµä»¥æ»¡è¶³é¡¹ç›®éœ€æ±‚

---

æœ‰é—®é¢˜ï¼ŸæŸ¥çœ‹ [GitHub Actions å®˜æ–¹æ–‡æ¡£](https://docs.github.com/en/actions) æˆ–åœ¨ä»“åº“ä¸­åˆ›å»º Issueï¼ğŸš€
